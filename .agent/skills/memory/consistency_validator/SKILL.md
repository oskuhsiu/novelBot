---
name: consistency_validator
description: 連戲檢查員 - 確保物品與角色狀態在相鄰場景間保持連續
---

# 連戲檢查員 (Consistency Validator)

## 功能概述

此 Skill 專注於「連戲」問題，確保故事在細節層面保持連貫。它主要關注：
- 物品的連續性（出現、消失、狀態變化）
- 角色的物理連續性（傷口、位置、穿著）
- 環境的連續性（時間、天氣、空間）

## 與 Logic Auditor 的區別

| 項目 | Logic Auditor | Consistency Validator |
|------|---------------|----------------------|
| 範圍 | 全局規則 | 場景間銜接 |
| 關注 | 設定矛盾 | 細節連戲 |
| 層級 | 宏觀 | 微觀 |
| 觸發 | 內容審查 | 場景切換 |

## 檢查項目

### 1. 物品連戲
```
- 上一場景：主角手持折疊飛劍
- 當前場景：主角徒手格擋
- 問題：飛劍去哪了？

修正方案：
A. 補充描寫「將飛劍收回腰間」
B. 當前場景改為「以飛劍格擋」
C. 解釋飛劍為何不在手中
```

### 2. 傷勢連戲
```
- 上一場景：主角左臂受傷
- 當前場景：主角雙手持劍

問題：左臂傷勢呢？

修正方案：
A. 改為單手持劍，左臂無力垂下
B. 補充「忍著左臂劇痛，強撐著握住劍柄」
```

### 3. 位置連戲
```
- 上一場景結尾：主角在倉庫
- 當前場景開頭：主角在酒吧

問題：如何從倉庫到酒吧？

修正方案：
A. 添加過渡場景或句子
B. 在場景開頭簡要交代移動過程
```

### 4. 時間連戲
```
- 上一場景：深夜
- 當前場景：陽光明媚

問題：經過多長時間？

修正方案：
A. 添加睡眠/時間流逝的描寫
B. 調整時間描述
```

## 執行步驟

### Step 1: 讀取相鄰場景
```
讀取上一場景結尾狀態：{{previous_ending_state}}
讀取當前場景開頭：{{current_opening}}
```

### Step 2: 項目對照檢查
```
## 逐項對照

【物品】
上一場景：{{previous_items}}
當前場景：{{current_items}}
差異：{{differences}}
問題：{{issues}}

【身體狀態】
上一場景：{{previous_condition}}
當前場景：{{current_condition}}
差異：{{differences}}
問題：{{issues}}

【位置】
上一場景：{{previous_location}}
當前場景：{{current_location}}
移動合理性：{{assessment}}

【在場人物】
上一場景：{{previous_present}}
當前場景：{{current_present}}
變化說明：{{explanation_needed}}
```

### Step 3: 輸出連戲報告
```yaml
consistency_report:
  scene_transition: "{{scene_A}} → {{scene_B}}"
  
  issues:
    - category: "item"
      problem: "飛劍狀態未說明"
      severity: "minor"
      fix: "添加收劍動作描寫"
      
  smooth_transitions:
    - "時間流逝合理"
    - "情緒延續自然"
    
  status: "需要小幅調整"
```

## 自動修復建議

### 物品過渡模板
```markdown
收起物品：
- 「他將飛劍收回背後的劍鞘」
- 「把硬盤塞進風衣內袋」

拿出物品：
- 「她從袖中滑出一柄短刃」
- 「他摸出上次收好的通訊器」
```

### 傷勢提醒模板
```markdown
輕傷：
- 「傷口還在隱隱作痛」
- 「他下意識護住受傷的部位」

重傷：
- 「每一次呼吸都牽動傷口」
- 「左臂幾乎無法抬起」
```

### 位置過渡模板
```markdown
短距離：
- 「穿過走廊，他來到...」
- 「推開門，眼前是...」

長距離：
- 「三個小時後，他終於抵達...」
- 「穿越半個城區，他站在...面前」

時間跳躍：
- 「第二天清晨...」
- 「一夜無話。天亮時...」
```

## 使用時機

- **場景切換時**：每次場景轉換前檢查
- **節拍開始前**：確保與上一節拍銜接
- **寫作即時**：作為 Scene Writer 的預檢

## 與其他 Skill 的關聯

- **讀取**：
  - `skill_status_monitor`（場景狀態）
- **協作**：
  - `skill_logic_auditor`（互補檢查）
- **輸出到**：
  - `skill_scene_writer`（銜接建議）

## 注意事項

1. **微觀視角**：關注的是相鄰場景，不是全局
2. **快速檢查**：應該是輕量級的即時檢查
3. **靈活處理**：輕微問題可以在寫作中自然解決
4. **不要過度**：不需要每個細節都完美銜接
5. **讀者視角**：關注讀者會注意到的問題
